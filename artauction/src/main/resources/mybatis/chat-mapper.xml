<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0 //EN" "https://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="chat">
	<!-- 목록 -->
	<select id="list" resultType="ChatDto">
		<include refid="top-n-header"></include>
		select * from chat order by
		chat_no
		asc	
		<include refid="top-n-footer"></include>
	</select>

	<!-- 사퀀스 등록 -->
	<select id="sequence" resultType="int">
		select chat_seq.nextval from dual
	</select>
	
	<!-- 등록 -->
	<insert id="send">
		insert into chat
		(
		chat_no,
		chat_sender,
		chat_receiver,
		chat_content
		)
		values
		(
		#{chatNo},
		#{chatSender},
		#{chatReceiver, jdbcType=VARCHAR},
		#{chatContent}
		)
	</insert>
	<!-- 헤더 푸터 추가 -->
	<sql id="top-n-header">
		<if test="beginRow != null and endRow != null">
			select * from (
			select rownum rn, TMP.* from(
		</if>
	</sql>
	<sql id="top-n-footer">
		<if test="beginRow != null and endRow != null">
			)TMP
			)
			where rn between #{beginRow} and #{endRow}
		</if>
	</sql>


</mapper>